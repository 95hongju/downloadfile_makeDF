<style>
#title {
    font-family: "Arial Black", Gadget, sans-serif;
    font-size: 30px;
    letter-spacing: 2px;
    word-spacing: 2px;
    color: #000000;
    font-weight: 700;
    text-decoration: none;
    font-style: italic;
    font-variant: normal;
    text-transform: none;
    }
  #bd{
    font-family: "Arial Black", Gadget, sans-serif;
    font-size: 15 px;
    font-weight: 700;
  }

</style>
<title>
    Home/Low Quality Marker/Download Table
</title>

<br>
<div id='title'>
    ☝️ Low Quality Marker Download Table
    <br>
</div>



<table border=0 align=center  style="font-size: 12pt;
border: 3px lightgray solid;
border-radius: 15px;
padding-right: 10px;
width:100%; height:80%;
padding-left: 10px;" class="fixed_header">

<thead>
        <tr>
                <td colspan=6>
                  <h4>
                    <br> VERSION : {{ version }} <br>
                    {% if srh %}
                    <br> VALUE : {{ srh }} <br>
                    {% endif %}
                    <br>TOTAL : {{ result|length }} <br>
                  </h4>
                    
                      <input type=button onclick="exportTableToCSV('result(low_quality_marker).csv')" value='CURRENT PAGE CSV DOWNLOAD' style="width:30%;"></button>

                </td>
            </tr>
  <tr align=center>

  <td id ='bd'>   CHR </td>
  <td id ='bd'>   POS  </td>
  <td id ='bd'>   rsID </td>
  <td id ='bd'>   Reason  </td>
  <td id ='bd'>  Registered By  </td>
  <td id ='bd'>   Date  </td>

  </tr>
</thead>

<tbody>

  {% if result %}
  {% for v in result %}
  <tr align=center>


    <td id='s'>{{ v.chr }}</td>
    <td id='m'>{{ v.pos }}</td>
    <td id='m'>{{ v.rsid }}</td>
    <td id='l'>{{ v.reason }}</td>
    <td id='xl'>{{ v.who }}</td>
    <td id='m'>{{ v.date.date }}</td>
  </tr>
  {% endfor %}

  {% else %}
  <tr>
    <td colspan=6 class='messages' style="font-size:100%;"><br>N O N E D A T A
    </td>
  </tr>
  {% endif %}
</tbody>
</table>



<script>
        function downloadCSV(csv, filename) {
          var csvFile;
          var downloadLink;
        
          // CSV file
          csvFile = new Blob([csv], {type: "text/csv"});
        
          // Download link
          downloadLink = document.createElement("a");
        
          // File name
          downloadLink.download = filename;
        
          // Create a link to the file
          downloadLink.href = window.URL.createObjectURL(csvFile);
        
          // Hide download link
          downloadLink.style.display = "none";
        
          // Add the link to DOM
          document.body.appendChild(downloadLink);
        
          // Click download link
          downloadLink.click();
        }
        
        function exportTableToCSV(filename) {
          var csv = [];
          var rows = document.querySelectorAll("table tr");
        
          for (var i = 0; i < rows.length; i++) {
            var tb=rows[i].querySelectorAll("table");
            if( tb.length !== 0){
                continue;
            }
            txt = rows[i].innerText
            csv.push(txt);
          }
        
          // Download CSV file
          downloadCSV(csv.join("\n"), filename);
        }
        </script>
        